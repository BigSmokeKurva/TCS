import { useRef, forwardRef, useImperativeHandle, useState } from 'react';
import styles from '../style.module.css';

const FieldInput = forwardRef((props, ref) => {
    const inputRef = useRef(null);
    const [error, setError] = useState(props.error);

    useImperativeHandle(ref, () => ({
        getInputValue: () => inputRef.current.value,
        setError: (value) => setError(value),
        getError: () => error,
        focus: () => inputRef.current.focus()
      }));

    function onFocus() {
        error && setError(null);
    }

    return (
        <div className={styles.sign_row}>
            <span>{props.text}</span>
            <input type={props.type} ref={inputRef} onFocus={onFocus} onKeyUp={event => {props.onKeyUp(event, ref)}}/>
            {
                error &&
                <div>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M8 0C8.73438 0 9.4401 0.0963542 10.1172 0.289062C10.7995 0.481771 11.4349 0.752604 12.0234 1.10156C12.6172 1.44531 13.1589 1.86198 13.6484 2.35156C14.138 2.84115 14.5547 3.38281 14.8984 3.97656C15.2474 4.5651 15.5182 5.20052 15.7109 5.88281C15.9036 6.5599 16 7.26562 16 8C16 8.72917 15.9036 9.4349 15.7109 10.1172C15.5182 10.7943 15.2474 11.4297 14.8984 12.0234C14.5495 12.6172 14.1302 13.1589 13.6406 13.6484C13.1562 14.1328 12.6172 14.5495 12.0234 14.8984C11.4297 15.2474 10.7943 15.5182 10.1172 15.7109C9.4401 15.9036 8.73438 16 8 16C7.27083 16 6.5651 15.9036 5.88281 15.7109C5.20573 15.5182 4.57031 15.2474 3.97656 14.8984C3.38281 14.5495 2.84115 14.1328 2.35156 13.6484C1.86719 13.1589 1.45052 12.6172 1.10156 12.0234C0.752604 11.4297 0.481771 10.7943 0.289062 10.1172C0.0963542 9.4349 0 8.72917 0 8C0 7.26562 0.0963542 6.5599 0.289062 5.88281C0.481771 5.20573 0.752604 4.57031 1.10156 3.97656C1.45052 3.38281 1.86719 2.84375 2.35156 2.35938C2.84115 1.86979 3.38281 1.45052 3.97656 1.10156C4.57031 0.752604 5.20573 0.481771 5.88281 0.289062C6.5651 0.0963542 7.27083 0 8 0ZM5.47656 7.15625C5.36719 7.15625 5.26042 7.17969 5.15625 7.22656C5.05729 7.27344 4.96875 7.33594 4.89062 7.41406C4.8125 7.49219 4.75 7.58333 4.70312 7.6875C4.65625 7.78646 4.63281 7.89062 4.63281 8C4.63281 8.10938 4.65625 8.21615 4.70312 8.32031C4.75 8.41927 4.8125 8.50781 4.89062 8.58594C4.96875 8.66406 5.05729 8.72656 5.15625 8.77344C5.26042 8.82031 5.36719 8.84375 5.47656 8.84375H10.5234C10.6328 8.84375 10.737 8.82031 10.8359 8.77344C10.9401 8.72656 11.0312 8.66406 11.1094 8.58594C11.1875 8.50781 11.25 8.41927 11.2969 8.32031C11.3438 8.21615 11.3672 8.10938 11.3672 8C11.3672 7.89062 11.3438 7.78646 11.2969 7.6875C11.25 7.58333 11.1875 7.49219 11.1094 7.41406C11.0312 7.33594 10.9401 7.27344 10.8359 7.22656C10.737 7.17969 10.6328 7.15625 10.5234 7.15625H5.47656Z" fill="#C4314B" />
                    </svg>
                    <span>{error}</span>
                </div>
            }
        </div>
    );
});

export default FieldInput;